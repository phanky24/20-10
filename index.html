<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Ph·ª• N·ªØ Vi·ªát Nam</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Mali:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,200;1,300;1,400;1,500;1,600;1,700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --accent: #ffffff;
            --accent-2: #eb67e0;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            font-family: "Mali", cursive;
            background: #ffffff;
            overflow: hidden;
        }

        .stage {
            position: relative;
            min-height: 100vh;
            overflow: hidden;
        }

        canvas#starfield {
            display: block;
            width: 100%;
            height: 100%;
        }

        @media (max-width:600px) {
            .moon {
                top: 40px;
                right: 14px;
                width: 70px;
                height: 70px;
            }

        }

        #lantern-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 100;
        }

        .lantern {
            position: absolute;
            pointer-events: auto;
            width: 40px;
            user-select: none;
        }

        @keyframes swing {
            0% {
                transform: rotate(-5deg);
            }

            50% {
                transform: rotate(5deg);
            }

            100% {
                transform: rotate(-5deg);
            }
        }

        .swing {
            animation: swing 2s ease-in-out infinite;
        }

        #hint {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(194, 176, 176, 0);
            color: #f269c9;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 28px;
            font-weight: 800;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 1000;
            pointer-events: none;
            text-align: center;
            white-space: nowrap;
            text-shadow:
                0 0 15px #ff50ee,
                0 0 20px #ff80d3;

        }

        @media (max-width: 600px) {
            #hint {
                font-size: 22px;
                padding: 8px 12px;
            }
        }

        #wish-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.96);
            color: #ff8d22;
            padding: 35px 40px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: 700;
            display: none;
            z-index: 9999;
            box-shadow: 0 6px 30px rgba(0, 0, 0, 0.35);
            text-align: center;
            max-width: 60%;
            width: auto;
            box-sizing: border-box;
            pointer-events: auto;
            text-shadow:
                0 0 25px #ffd180;
            box-shadow:
                0 0 20px #ff8a50,
                0 0 25px #ffd180;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #title {
            position: fixed;
            top: 50px;
            left: 5%;
            transform: translateX(-50%);
            background: rgba(194, 176, 176, 0);
            color: #f269c9;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 37px;
            font-weight: 800;
            opacity: 0;
            transition: opacity fadeIn 1.5s ease-in forwards;
            z-index: 1000;
            pointer-events: none;
            text-align: center;
            white-space: nowrap;
            text-shadow:
                0 0 15px #ff50ee,
                0 0 20px #ff80d3;

        }

        @media (max-width: 600px) {
            #wish-popup {
                font-size: 1.2rem;
                padding: 20px 25px;
                max-width: 80%;
                width: 80%;
            }
        }

        .controls {
            position: fixed;
            left: 18px;
            top: 18px;
            z-index: 10;
            color: #fff;
            font-size: 14px;
            background: rgba(0, 0, 0, 0.2);
            padding: 8px 12px;
            border-radius: 10px;
        }

        .music-toggle {
            cursor: pointer;
            margin-left: 10px;
            color: #fff;
            opacity: 0.95;
        }

        #bottom-image-container {
            position: fixed;
            bottom: 0;
            right: 20px;
            transform: none;
            z-index: 5;
            pointer-events: none;
        }

        #bottom-image-container img {
            height: 80px;
            width: auto;
            display: block;
        }

        @media (max-width: 600px) {
            #bottom-image-container img {
                height: 20px;
            }
        }

        /* === THI·ªÜP M·ªû === */
        #card-wrapper {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 99999;
        }

        #card {
            position: relative;
            width: 360px;
            height: 240px;
            perspective: 1000px;
        }

        .card-front,
        .card-inner {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 12px;
            backface-visibility: hidden;
            transition: transform 1.2s ease-in-out;
        }

        .card-front {
            background: linear-gradient(160deg, #ff9be6, #ff63c0);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
            transform-origin: left;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .triangle {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 60px solid transparent;
            border-right: 60px solid transparent;
            border-bottom: 50px solid rgba(255, 255, 255, 0.8);
        }

        .card-inner {
            background: #fffef5;
            color: #d6519f;
            padding: 30px 25px;
            box-shadow: inset 0 0 25px rgba(0, 0, 0, 0.15);
            transform: rotateY(-180deg);
            font-size: 18px;
            line-height: 1.6;
            font-weight: 600;
        }

        #card.open .card-front {
            transform: rotateY(-180deg);
        }

        #card.open .card-inner {
            transform: rotateY(0deg);
        }

        @media (max-width: 600px) {
            #card {
                width: 260px;
                height: 180px;
            }

            .card-inner {
                font-size: 15px;
            }
        }
    </style>
</head>

<body>
    <div class="stage">
        <canvas id="starfield"></canvas>
        <div id="title">Ch√∫c m·ª´ng ng√†y ph·ª• n·ªØ Vi·ªát Nam 20 - 10</div>
        <div id="lantern-container"></div>

        <div id="wish-popup" role="dialog" aria-live="polite"></div>

        <div id="bottom-image-container">
        </div>

        <div id="hint">Ch·∫°m v√†o hoa</div>

        <audio id="bg-music" loop>
            <source src="a.mp3" type="audio/mp3">
            Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ th·∫ª audio.
        </audio>
    </div>

    <!-- Thi·ªáp m·ªü -->
    <div id="card-wrapper">
        <div id="card">
            <div class="card-front">
                <div class="triangle"></div>
            </div>
            <div class="card-inner">
                <p>G·ª≠i ƒë·∫øn b·∫°n, ng∆∞·ªùi ph·ª• n·ªØ tuy·ªát v·ªùi nh·∫•t üå∏<br><br>
                    Ch√∫c b·∫°n lu√¥n m·∫°nh m·∫Ω, xinh ƒë·∫πp v√† h·∫°nh ph√∫c trong m·ªçi h√†nh tr√¨nh! üíñ<br><br>
                    ‚Äî 20/10 th·∫≠t r·ª±c r·ª° nh√© üíê</p>
            </div>
        </div>
    </div>

    <script>
    // ===== Canvas sao v√† sao bƒÉng =====
    const canvas = document.getElementById("starfield");
    const ctx = canvas.getContext("2d");
    let w, h, stars = [], meteors = [];

    function resizeCanvas() {
        w = canvas.width = innerWidth;
        h = canvas.height = innerHeight;
        stars = [];
        const count = Math.round((w * h) / 2200);
        for (let i = 0; i < count; i++) {
            stars.push({
                x: Math.random() * w,
                y: Math.random() * h,
                r: Math.random() * 0.9 + 0.1,
                a: Math.random() * 0.8 + 0.2,
                t: Math.random() * 0.02 + 0.002
            });
        }
    }

    function drawStars() {
        ctx.clearRect(0, 0, w, h);
        for (const s of stars) {
            s.a += (Math.random() > 0.5 ? 1 : -1) * s.t;
            s.a = Math.max(0.05, Math.min(1, s.a));
            ctx.beginPath();
            ctx.globalAlpha = s.a;
            ctx.fillStyle = "#fff";
            ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
            ctx.fill();
        }
        ctx.globalAlpha = 1;
    }

    function createMeteor() {
        const startX = Math.random() * w;
        const startY = Math.random() * (h / 3);
        const speed = Math.random() * 10 + 6;
        meteors.push({
            x: startX,
            y: startY,
            vx: speed + 6,
            vy: speed / 2,
            len: Math.random() * 120 + 100,
            a: 1
        });
    }

    function drawMeteors() {
        for (let i = meteors.length - 1; i >= 0; i--) {
            const m = meteors[i];
            const x2 = m.x - m.len;
            const y2 = m.y - m.len / 2;
            const g = ctx.createLinearGradient(m.x, m.y, x2, y2);
            g.addColorStop(0, `rgba(255,255,255,${m.a})`);
            g.addColorStop(1, "rgba(255,255,255,0)");
            ctx.strokeStyle = g;
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(m.x, m.y);
            ctx.lineTo(x2, y2);
            ctx.stroke();
            m.x += m.vx;
            m.y += m.vy;
            m.a -= 0.02;
            if (m.a <= 0 || m.x > w + 200 || m.y > h + 200) meteors.splice(i, 1);
        }
        ctx.strokeStyle = "#fff";
        ctx.lineWidth = 1;
    }

    function loop() {
        drawStars();
        drawMeteors();
        if (Math.random() < 0.01) createMeteor();
        requestAnimationFrame(loop);
    }

    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();
    loop();

    // ===== hoa v√† l·ªùi ch√∫c =====
    const lanternContainer = document.getElementById("lantern-container");
    function createLantern() {
        const lantern = document.createElement("img");
        lantern.src = "./hoa.png";
        lantern.className = "lantern swing";

        const layer = Math.floor(Math.random() * 3) + 1;
        let size = 40, duration = 10000, opacity = 0.8;

        if (layer === 1) {
            size = (20 + Math.random() * 20) * 1.25;
            duration = 14000 + Math.random() * 5000;
            opacity = 0.55;
        } else if (layer === 2) {
            size = (30 + Math.random() * 30) * 1.25;
            duration = 12000 + Math.random() * 4000;
            opacity = 0.75;
        } else {
            size = (40 + Math.random() * 40) * 1.25;
            duration = 10000 + Math.random() * 3000;
            opacity = 0.95;
        }

        lantern.style.width = size + "px";
        lantern.style.left = Math.random() * 90 + "vw";
        lantern.style.bottom = "0px";
        lantern.style.opacity = opacity;

        lanternContainer.appendChild(lantern);

        const drift = Math.random() * 140 - 70;
        const up = 120 + Math.random() * 40;
        lantern.animate(
            [
                { transform: "translate(0,0)", opacity: opacity },
                { transform: `translate(${drift}px, -${up}vh)`, opacity: 0 }
            ],
            { duration: duration, easing: "linear", fill: "forwards" }
        );

        setTimeout(() => lantern.remove(), duration);
    }

    const lanternInterval = setInterval(createLantern, 500);

    // ===== Nh·∫°c n·ªÅn =====
    const bg = document.getElementById("bg-music");
    const hint = document.getElementById("hint");
    let musicStarted = false;
    document.addEventListener("pointerdown", function startMusicOnce() {
        if (!musicStarted && bg) {
            bg.volume = 0;
            bg.play().then(() => {
                let v = 0;
                const fadeIn = setInterval(() => {
                    v += 0.05;
                    if (v >= 0.9) {
                        v = 0.9;
                        clearInterval(fadeIn);
                    }
                    bg.volume = v;
                }, 120);
                musicStarted = true;
                for (let i = 0; i < 4; i++) {
                    setTimeout(createLantern, i * 300);
                }
            }).catch(() => { });
        }
        document.removeEventListener("pointerdown", startMusicOnce);
    });

    setTimeout(() => {
        hint.style.opacity = "1";
        setTimeout(() => { hint.style.opacity = "0"; }, 5000);
    }, 1000);

    window.addEventListener("load", () => {
        const title = document.getElementById("title");
        title.style.animation = "fadeIn 3s ease-in forwards";
    });

    // === HI·ªÜU ·ª®NG M·ªû THI·ªÜP ===
    function openCard() {
        const cardWrapper = document.getElementById("card-wrapper");
        const card = document.getElementById("card");
        cardWrapper.style.display = "flex";
        setTimeout(() => card.classList.add("open"), 200);
        cardWrapper.addEventListener("click", (e) => {
            if (e.target === cardWrapper) {
                card.classList.remove("open");
                setTimeout(() => (cardWrapper.style.display = "none"), 600);
            }
        });
    }

    // === ·∫¢NH BAY NGANG ===
    const imageContainer = document.createElement("div");
    imageContainer.style.position = "fixed";
    imageContainer.style.top = "0";
    imageContainer.style.left = "0";
    imageContainer.style.width = "100%";
    imageContainer.style.height = "100%";
    imageContainer.style.pointerEvents = "none";
    imageContainer.style.zIndex = "500";
    document.body.appendChild(imageContainer);

    const imageSources = [
        "./anh1.png",
        "./anh2.png",
        //"./anh3.png",
        //"./anh4.png",
        //"./anh5.png"
    ];

    function createFlyingImage() {
        const img = document.createElement("img");
        img.src = imageSources[Math.floor(Math.random() * imageSources.length)];
        img.style.position = "absolute";
        img.style.left = "-100px";
        img.style.top = Math.random() * 80 + "vh";
        img.style.width = 50 + Math.random() * 50 + "px";
        img.style.opacity = 0.8 + Math.random() * 0.2;

        imageContainer.appendChild(img);

        const duration = 10000 + Math.random() * 4000;
        const endY = Math.random() * 80 + "vh";
        img.animate(
            [
                { transform: "translateX(0)", opacity: img.style.opacity },
                { transform: `translateX(110vw)`, opacity: 0.6 }
            ],
            { duration: duration, easing: "linear", fill: "forwards" }
        );

        setTimeout(() => img.remove(), duration);
    }

    let imageInterval;

    lanternContainer.addEventListener("click", (e) => {
        if (e.target.classList.contains("lantern")) {
            e.stopPropagation();

            // üõë D·ª´ng t·∫°o hoa
            clearInterval(lanternInterval);

            // üå∏ M·ªü thi·ªáp
            openCard();

            // üåà B·∫Øt ƒë·∫ßu hi·ªáu ·ª©ng ·∫£nh bay
            if (!imageInterval) {
                imageInterval = setInterval(createFlyingImage, 300);
            }
        }
    });
</script>


</body>

</html>